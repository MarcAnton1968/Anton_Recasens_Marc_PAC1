---
title: "Anàlisi de dades òmiques (M0-157). PAC1."
author: "Marc Anton"
date: "`r Sys.Date()`"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 1. Introducció

Aquest arxiu conté les sol·lucions als problemes plantejats en la PAC1 *Anàlisi de dades òmiques (M0-157)*. El projecte total del treball es pot consultar al: meu repositori github, cliqueu **[aquí](https://github.com/MarcAnton1968/Anton_Recasens_Marc_PAC1/tree/master)**

# 2. Carrega de dades

A continuació, procedeixo a resoldre la PAC. Abans que res, carreguem les dades al nostre entorn de treball. Treballarem amb l'exemple de mostra, veure **[aquí](https://github.com/nutrimetabolomics/metaboData/tree/main/Datasets/2018-MetabotypingPaper)**. Carreguem els dos fitxers:

```{r}
DataInfo_S013 <- read.csv("DataInfo_S013.csv", sep = ",")
DataValues_S013 <- read.csv("DataValues_S013.csv", sep = ",")
```

Com que ja sabem que aquests fitxers solen portar molts camps, mirem primer l'estructura dels dos.

# 3. Eploració previa de les dades descarregades

```{r}
dim(DataInfo_S013)
dim(DataValues_S013)
```

Aqui ja veiem que en l'arxiu Values tenim 696 columnes, el que correspon a un index únic de cada cas d'estudi més les 695 variables que es tenen de cada un d'ells. Per veure que hi ha, mirem les 20 primeres files d'Info i podem fer-nos una idea

```{r}
head(DataInfo_S013,20)
```

Aqui ja veiem que hi ha 9 primers camps que semblen ser els que tenen la informació sobre el pacient mostra. Mirem que contenen aquests camps a values:

```{r}
# En mirem 10 en realitat, per comprovar que la primera columna és un index
head(DataValues_S013[,1:10])
```

Com suposavem, aquestes columnes corresponen a:
1. Un codi de pacient (que està repetit a les dues primeres columnes)
2. La cirugia a la que va ser sotmés el pacient
3. L'edat i el gènere
4. Un grup de tractament
5. 4 tractaments que venen amb 0 i 1

Per veure que la resta són metabolits, mirem 5 columnes més

```{r}
head(DataValues_S013[,11:15],10)
```

Obviament ja ho veiem i també podem veure que hi ha més d'un valor que no es té (NA)

# Generació de l'obsject SummarizedExperiment

Ara que ja sabem que tenim a les dades, podem procedir a carregar-les en un objecte *SummarizedExperiment*. Per a fer-ho, convertirem però les dades a un data frame i li traurem la primera columna que ja hem vist que és redundant amb la segona. Aleshores ja ho podem carregar. En concret, carregarem:

1. L'arxiu DataVAlues com a assays que és on es guarden les dades de les mostres que tenim
2. L'arxiu DataInfo com a colData que és on es guarda la informació de com és cada columna d'assays.

```{r}
# Primer carreguem la llibreria per poder tractar el SummarizedExperiment
library(SummarizedExperiment)
# Primer eliminem la primera columna de DataValues i ho guardem com un data frame que és el que accepta SummarizedExperiment
DataValues_S013_matrix <- DataValues_S013[,-1]
# Ara ja podem carregar el SummarizedExperiment
seMA <- SummarizedExperiment(assays = list(counts = DataValues_S013_matrix),
                             colData = DataInfo_S013)
seMA
```

Sembla que l'objecte s'ha generat correctament

Mirem un parell de funcions que es poden fer. 

```{r}
# Comprovem com es diuen les columnes que tenim en cada una de les classes de dins de l'objecte
dimnames(seMA)
# I ara mirem les 10 primeres columnes i les 5 primeres files d'assays
assay(seMA)[1:5, 1:10]
# I també mirem com ha quedat colData
colData(seMA)
```





